% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SolarCommand.R
\name{PedifromSNPs}
\alias{PedifromSNPs}
\title{R6 Class: PedifromSNPs}
\description{
Represents the SOLAR \code{pedifromsnps} subcommand, which constructs a pedigree relationship matrix from SNP data in PLINK format.
}
\details{
The \code{pedifromsnps} command creates an empirical genetic relatedness matrix (GRM) using SNP data provided in PLINK binary format.
It supports multiple computation methods including correlation-based GRMs, KING-robust estimators, and per-chromosome GRMs.

Required inputs include:
\itemize{
\item \code{-i}: PLINK input base filename (without extension)
\item \code{-o}: Output base filename
\item \code{--freq}: Frequency file from PLINK
}

Optional settings allow users to control correlation alpha, enable KING or method 2 GRMs, apply subject ID filters, adjust batch size, or multithread the computation.
\subsection{SOLAR Manual Syntax:}{

\if{html}{\out{<div class="sourceCode">}}\preformatted{pedifromsnps -i <plink input basename>
             -o <output basename>
             --freq <plink frequency file>
             [options]
}\if{html}{\out{</div>}}
}

\subsection{Optional Flags:}{
\itemize{
\item \verb{-corr <alpha>}: Alpha value for correlation GRM
\item \code{-per-chromo}: Output GRMs per chromosome
\item \code{-king}: Use KING robust relatedness
\item \code{-method_two}: Use second GRM computation method
\item \code{-normalize}: Normalize correlation GRMs
\item \verb{-batch_size <n>}: Batch size for multithreaded computation
\item \verb{-id_list <file>}: Restrict GRM to listed subject IDs
\item \verb{-n_threads <n>}: Number of CPU threads to use
}
}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-PedifromSNPs-new}{\code{PedifromSNPs$new()}}
\item \href{#method-PedifromSNPs-print}{\code{PedifromSNPs$print()}}
\item \href{#method-PedifromSNPs-get_input_fbase}{\code{PedifromSNPs$get_input_fbase()}}
\item \href{#method-PedifromSNPs-get_output_fbase}{\code{PedifromSNPs$get_output_fbase()}}
\item \href{#method-PedifromSNPs-get_freq_fbase}{\code{PedifromSNPs$get_freq_fbase()}}
\item \href{#method-PedifromSNPs-get_corr}{\code{PedifromSNPs$get_corr()}}
\item \href{#method-PedifromSNPs-get_per_chromo}{\code{PedifromSNPs$get_per_chromo()}}
\item \href{#method-PedifromSNPs-get_king}{\code{PedifromSNPs$get_king()}}
\item \href{#method-PedifromSNPs-get_method_two}{\code{PedifromSNPs$get_method_two()}}
\item \href{#method-PedifromSNPs-get_batch_size}{\code{PedifromSNPs$get_batch_size()}}
\item \href{#method-PedifromSNPs-get_id_list}{\code{PedifromSNPs$get_id_list()}}
\item \href{#method-PedifromSNPs-get_n_threads}{\code{PedifromSNPs$get_n_threads()}}
\item \href{#method-PedifromSNPs-clone}{\code{PedifromSNPs$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-new"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-new}{}}}
\subsection{Method \code{new()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$new(
  input_fbase = NULL,
  output_fbase = NULL,
  freq_fbase = NULL,
  corr = NULL,
  per_chromo = FALSE,
  king = FALSE,
  method_two = FALSE,
  batch_size = NULL,
  id_list = NULL,
  n_threads = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{input_fbase}}{Character. Required. Base filename of the PLINK input set (.bed, .bim, .fam).}

\item{\code{output_fbase}}{Character. Required. Base filename for output GRM and metadata files.}

\item{\code{freq_fbase}}{Character. Required. Path to frequency file generated by PLINK (e.g., \code{plink.frq}).}

\item{\code{corr}}{Numeric. Optional. Alpha value for correlation-based GRM estimation.}

\item{\code{per_chromo}}{Logical. Optional. Whether to compute separate GRMs per chromosome. Default is \code{FALSE}.}

\item{\code{king}}{Logical. Optional. Whether to use the KING robust method for GRM computation. Default is \code{FALSE}.}

\item{\code{method_two}}{Logical. Optional. Use second correlation GRM computation method. Default is \code{FALSE}.}

\item{\code{batch_size}}{Integer. Optional. Number of loci processed per thread per batch. Default is \code{500}.}

\item{\code{id_list}}{Character. Optional. Path to file listing subject IDs to include in GRM.}

\item{\code{n_threads}}{Integer. Optional. Number of CPU threads to use. Default is system-determined.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new \code{PedifromSNPs} object containing configuration for the SOLAR \code{pedifromsnps} command.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-print"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-print}{}}}
\subsection{Method \code{print()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$print()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisibly returns \code{self}. Prints a summary of the GRM configuration.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_input_fbase"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_input_fbase}{}}}
\subsection{Method \code{get_input_fbase()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_input_fbase()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string containing the base filename for PLINK input files.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_output_fbase"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_output_fbase}{}}}
\subsection{Method \code{get_output_fbase()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_output_fbase()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string representing the GRM output base filename.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_freq_fbase"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_freq_fbase}{}}}
\subsection{Method \code{get_freq_fbase()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_freq_fbase()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string containing the path to the PLINK frequency file.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_corr"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_corr}{}}}
\subsection{Method \code{get_corr()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_corr()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A numeric value indicating the correlation GRM alpha parameter.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_per_chromo"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_per_chromo}{}}}
\subsection{Method \code{get_per_chromo()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_per_chromo()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Logical. \code{TRUE} if per-chromosome GRM output is enabled; otherwise \code{FALSE}.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_king"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_king}{}}}
\subsection{Method \code{get_king()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_king()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Logical. \code{TRUE} if KING GRM computation is enabled; otherwise \code{FALSE}.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_method_two"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_method_two}{}}}
\subsection{Method \code{get_method_two()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_method_two()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Logical. \code{TRUE} if GRM method two is selected; otherwise \code{FALSE}.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_batch_size"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_batch_size}{}}}
\subsection{Method \code{get_batch_size()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_batch_size()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Logical. \code{TRUE} if GRM method two is selected; otherwise \code{FALSE}.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_id_list"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_id_list}{}}}
\subsection{Method \code{get_id_list()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_id_list()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string representing the path to a subject ID list file.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-get_n_threads"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-get_n_threads}{}}}
\subsection{Method \code{get_n_threads()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$get_n_threads()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Integer. The number of threads to use for parallel GRM computation.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PedifromSNPs-clone"></a>}}
\if{latex}{\out{\hypertarget{method-PedifromSNPs-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PedifromSNPs$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
