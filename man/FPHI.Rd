% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SolarCommand.R
\name{FPHI}
\alias{FPHI}
\title{R6 Class: FPHI}
\description{
Represents the SOLAR \code{fphi} subcommand for fast heritability approximation using eigenvalue decomposition of the kinship matrix.
}
\details{
\code{fphi} is a performance-optimized method in SOLAR for estimating heritability (\code{h2}) using analytic or permutation-based inference.
It leverages EVD data to speed up computation. The \code{-fast} option uses the Wald approximation; the default behavior conducts
a full grid search for maximum-likelihood \code{h2} values up to 9 decimal places.

Optional inputs include:
\itemize{
\item \code{-list}: Path to a file containing trait names.
\item \code{-mask}: NIfTI template for voxel-based analysis.
\item \code{-precision}: Number of decimals for \code{h2} inference.
\item \code{-evd_data}: Precomputed EVD base filename to reuse.
}

This is especially useful for high-dimensional neuroimaging traits and large family-based datasets.
\subsection{SOLAR Manual Syntax:}{

\if{html}{\out{<div class="sourceCode">}}\preformatted{fphi [options]
}\if{html}{\out{</div>}}
}

\subsection{Example Options:}{
\itemize{
\item \code{-fast}
\item \code{-debug}
\item \verb{-list traitlist.txt}
\item \verb{-precision 4}
\item \verb{-mask brain_mask.nii.gz}
\item \verb{-evd_data evd/pedigree}
}
}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-FPHI-new}{\code{FPHI$new()}}
\item \href{#method-FPHI-print}{\code{FPHI$print()}}
\item \href{#method-FPHI-print_self}{\code{FPHI$print_self()}}
\item \href{#method-FPHI-get_opts}{\code{FPHI$get_opts()}}
\item \href{#method-FPHI-get_opts_fname}{\code{FPHI$get_opts_fname()}}
\item \href{#method-FPHI-get_precision}{\code{FPHI$get_precision()}}
\item \href{#method-FPHI-get_mask}{\code{FPHI$get_mask()}}
\item \href{#method-FPHI-get_evd_data}{\code{FPHI$get_evd_data()}}
\item \href{#method-FPHI-clone}{\code{FPHI$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-new"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-new}{}}}
\subsection{Method \code{new()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$new(
  opts = NULL,
  opts_fname = NULL,
  precision = NULL,
  mask = NULL,
  evd_data = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{opts}}{Character. Optional. SOLAR \code{fphi} flags such as \code{"-fast"} or \code{"-debug"}.}

\item{\code{opts_fname}}{Character. Optional. Path to a file listing trait names (used with \code{-list}).}

\item{\code{precision}}{Numeric. Optional. Number of decimal places to estimate \code{h2} (e.g., \code{4} for 0.0001).}

\item{\code{mask}}{Character. Optional. Path to a NIfTI mask file used to constrain voxel-based analysis.}

\item{\code{evd_data}}{Character. Optional. Base filename of EVD data to reuse, avoiding recomputation.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new \code{FPHI} object containing configuration for a SOLAR \code{fphi} command.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-print"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-print}{}}}
\subsection{Method \code{print()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$print()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisibly returns \code{self}. Prints all internal FPHI configuration values to the console.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-print_self"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-print_self}{}}}
\subsection{Method \code{print_self()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$print_self()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisibly returns \code{self}. Alias for \code{print()}, used for explicit self-inspection.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-get_opts"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-get_opts}{}}}
\subsection{Method \code{get_opts()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$get_opts()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string of flags passed to the \code{fphi} command (e.g., \code{"-fast"}).
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-get_opts_fname"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-get_opts_fname}{}}}
\subsection{Method \code{get_opts_fname()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$get_opts_fname()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string representing the filename passed via \code{-list}, or \code{NULL} if not used.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-get_precision"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-get_precision}{}}}
\subsection{Method \code{get_precision()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$get_precision()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A numeric value indicating the decimal precision requested for \code{h2} estimation.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-get_mask"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-get_mask}{}}}
\subsection{Method \code{get_mask()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$get_mask()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string specifying the path to the NIfTI mask file, or \code{NULL} if not provided.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-get_evd_data"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-get_evd_data}{}}}
\subsection{Method \code{get_evd_data()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$get_evd_data()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A character string representing the base name of EVD data to reuse.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FPHI-clone"></a>}}
\if{latex}{\out{\hypertarget{method-FPHI-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FPHI$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
